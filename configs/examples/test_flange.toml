name = "test_flange"

# =============================================================================
# Test Flange — drawing validation fixture
# Features: round disc, central bore, 4 bolt holes + counterbores,
#           2 dowel holes, oblong slot, chamfer on all edges
# =============================================================================

# --- Shapes ---

# Base: round flange disc (r=60, h=12)
[[shapes]]
id = "disc"
type = "cylinder"
radius = 60
height = 12

# Central bore (through-hole, r=15)
[[shapes]]
id = "bore"
type = "cylinder"
radius = 15
height = 16
position = [0, 0, -2]

# 4x Bolt holes (r=5) on PCD radius 45, at 0/90/180/270 degrees
[[shapes]]
id = "bolt_h1"
type = "cylinder"
radius = 5
height = 16
position = [45, 0, -2]

[[shapes]]
id = "bolt_h2"
type = "cylinder"
radius = 5
height = 16
position = [0, 45, -2]

[[shapes]]
id = "bolt_h3"
type = "cylinder"
radius = 5
height = 16
position = [-45, 0, -2]

[[shapes]]
id = "bolt_h4"
type = "cylinder"
radius = 5
height = 16
position = [0, -45, -2]

# 4x Counterbores (r=9, depth=4) at same bolt positions
[[shapes]]
id = "cb1"
type = "cylinder"
radius = 9
height = 6
position = [45, 0, 8]

[[shapes]]
id = "cb2"
type = "cylinder"
radius = 9
height = 6
position = [0, 45, 8]

[[shapes]]
id = "cb3"
type = "cylinder"
radius = 9
height = 6
position = [-45, 0, 8]

[[shapes]]
id = "cb4"
type = "cylinder"
radius = 9
height = 6
position = [0, -45, 8]

# 2x Dowel holes (r=3) on PCD radius 50, at 45/225 degrees
[[shapes]]
id = "dowel1"
type = "cylinder"
radius = 3
height = 16
position = [35.36, 35.36, -2]

[[shapes]]
id = "dowel2"
type = "cylinder"
radius = 3
height = 16
position = [-35.36, -35.36, -2]

# Oblong slot at (30, 0), oriented along Y, 8mm wide x 24mm long
# = box center + 2 cylinder end caps
[[shapes]]
id = "slot_rect"
type = "box"
length = 8
width = 16
height = 16
position = [26, -8, -2]

[[shapes]]
id = "slot_end1"
type = "cylinder"
radius = 4
height = 16
position = [30, 8, -2]

[[shapes]]
id = "slot_end2"
type = "cylinder"
radius = 4
height = 16
position = [30, -8, -2]

# --- Operations ---

# Cut central bore
[[operations]]
op = "cut"
base = "disc"
tool = "bore"
result = "body"

# Cut 4 bolt holes
[[operations]]
op = "cut"
base = "body"
tool = "bolt_h1"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "bolt_h2"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "bolt_h3"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "bolt_h4"
result = "body"

# Cut 4 counterbores
[[operations]]
op = "cut"
base = "body"
tool = "cb1"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "cb2"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "cb3"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "cb4"
result = "body"

# Cut 2 dowel holes
[[operations]]
op = "cut"
base = "body"
tool = "dowel1"
result = "body"

[[operations]]
op = "cut"
base = "body"
tool = "dowel2"
result = "body"

# Build slot tool (fuse rect + end caps), then cut
[[operations]]
op = "fuse"
base = "slot_rect"
tool = "slot_end1"
result = "slot_tool"

[[operations]]
op = "fuse"
base = "slot_tool"
tool = "slot_end2"
result = "slot_tool"

[[operations]]
op = "cut"
base = "body"
tool = "slot_tool"
result = "body"

# Chamfer all edges (C1.5 — distinct from bracket's fillet)
[[operations]]
op = "chamfer"
target = "body"
size = 1.5
result = "final"

# --- Drawing ---

[drawing]
views = ["front", "top", "right", "iso"]

[drawing.meta]
part_name = "Test Flange"
drawing_no = "FLG-001"
material = "AL6061-T6"
tolerance = "ISO 2768-m"
designed_by = "TH Jang"

# Detail view: zoom into counterbore area (bolt_h1 at x=45)
# center = [u, v] in front view coords (≈ [model_X, model_Z])
[drawing.detail]
center = [45, 10]
radius = 12
scale_factor = 3
label = "Z"
source_view = "front"

[drawing.style]
show_hidden = true
show_centerlines = true
show_dimensions = true

[drawing.tolerances]
general = "\u00b10.1"
holes = "H7"

# --- Export ---

[export]
formats = ["step", "stl"]
directory = "output"
